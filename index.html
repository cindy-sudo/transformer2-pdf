<!DOCTYPE html>
<html lang="zh-Hant">

<head>
  <meta charset="UTF-8" />
  <title>變壓器測試報告產出</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: "Noto Sans TC", sans-serif; }
    .table-bordered th,
    .table-bordered td { border: 1px solid black; }
  </style>
</head>

<body class="bg-gray-100 p-4">
  <div id="report" class="bg-white p-8 max-w-4xl mx-auto shadow-lg">
    <h1 class="text-2xl font-bold text-center mb-4">變壓器測試報告</h1>

    <!-- ★ 基本資料區：全部 placeholder 改成通用提示或直接移除 -->
<div class="grid grid-cols-2 gap-4 text-sm">
  <div>客戶：<input id="client"             class="border w-full" placeholder="請輸入客戶名稱"></div>
  <div>試驗日期：<input id="test_date"        class="border w-full" placeholder="YYYY.MM.DD"></div>

  <div>試驗地點：<input id="test_location"    class="border w-full" placeholder="請輸入地點"></div>
  <div>盤面名稱：<input id="panel_name"       class="border w-full" placeholder="請輸入盤面名稱"></div>

  <div>製造廠：<input id="manufacturer"     class="border w-full" placeholder="請輸入製造廠"></div>
  <div>一次電壓(流)：<input id="primary_voltage"   class="border w-full" placeholder=""></div>

  <div>製品型式：<input id="model_type"      class="border w-full" placeholder=""></div>
  <div>二次電壓(流)：<input id="secondary_voltage" class="border w-full" placeholder=""></div>

  <div>製造編號：<input id="serial_number"   class="border w-full" placeholder=""></div>
  <div>容量：<input id="capacity"          class="border w-full" placeholder=""></div>

  <div>製造日期：<input id="manufacture_date" class="border w-full" placeholder="YYYY.MM"></div>
</div>

    <h2 class="text-xl font-semibold mt-6 mb-2">絕緣電阻、耐壓特性試驗</h2>

    <!-- 以下試驗表若也要一開始全空，把 value 刪掉即可 -->
    <div class="overflow-x-auto text-sm">
      <!-- 變壓器一次測試 -->
      <table class="table-auto w-full table-bordered text-center">
        <thead>
          <tr><th colspan="5">變壓器一次測試</th></tr>
          <tr>
            <th>試驗電壓(kV)</th><th>洩漏電流(30秒)</th>
            <th>洩漏電流(60秒)</th><th>絕緣電阻(MΩ)</th><th>判定</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>12</td>
            <td><input class="border w-16 text-center"></td>
            <td><input class="border w-16 text-center"></td>
            <td rowspan="3"><input class="border w-24 text-center"></td>
            <td rowspan="3"></td>
          </tr>
          <tr>
            <td>24</td>
            <td><input class="border w-16 text-center"></td>
            <td><input class="border w-16 text-center"></td>
          </tr>
          <tr>
            <td>36</td>
            <td><input class="border w-16 text-center"></td>
            <td><input class="border w-16 text-center"></td>
          </tr>
        </tbody>
      </table>

      <!-- 變壓器二次測試 -->
      <table class="table-auto w-full table-bordered text-center mt-6">
        <thead>
          <tr><th colspan="5">變壓器二次測試</th></tr>
          <tr>
            <th>試驗電壓(kV)</th><th>洩漏電流(30秒)</th>
            <th>洩漏電流(60秒)</th><th>絕緣電阻(MΩ)</th><th>判定</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1.2</td>
            <td><input class="border w-16 text-center"></td>
            <td><input class="border w-16 text-center"></td>
            <td rowspan="3"><input class="border w-24 text-center"></td>
            <td rowspan="3"></td>
          </tr>
          <tr>
            <td>2.4</td>
            <td><input class="border w-16 text-center"></td>
            <td><input class="border w-16 text-center"></td>
          </tr>
          <tr>
            <td>3.6</td>
            <td><input class="border w-16 text-center"></td>
            <td><input class="border w-16 text-center"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-xs mt-4">
      *36 kV 持壓一分鐘無異常<br>
      *高壓側絕緣電阻 &gt; 1000 MΩ 屬良好<br>
      *低壓側絕緣電阻 &gt; 500 MΩ 屬良好
    </p>
  </div>

  <div class="text-center mt-6">
    <button onclick="generatePDF()" class="rounded bg-teal-600 px-6 py-2 font-medium text-white hover:bg-teal-700">
      下載 PDF
    </button>
  </div>

  <script>
    async function generatePDF () {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF("p", "pt", "a4");
      const report = document.getElementById("report");

      const canvas = await html2canvas(report, { scale: 2 });
      const imgData = canvas.toDataURL("image/png");
      doc.addImage(imgData, "PNG", 20, 20, 555, 0);
      doc.save("變壓器測試報告.pdf");
    }
  </script>
</body>
</html>
